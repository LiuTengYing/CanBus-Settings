{"version":3,"file":"forum.js","mappings":"MACA,IAAIA,EAAsB,CCA1BA,EAAyBC,IACxB,IAAIC,EAASD,GAAUA,EAAOE,WAC7B,IAAOF,EAAiB,QACxB,IAAM,EAEP,OADAD,EAAoBI,EAAEF,EAAQ,CAAEG,EAAGH,IAC5BA,CAAM,ECLdF,EAAwB,CAACM,EAASC,KACjC,IAAI,IAAIC,KAAOD,EACXP,EAAoBS,EAAEF,EAAYC,KAASR,EAAoBS,EAAEH,EAASE,IAC5EE,OAAOC,eAAeL,EAASE,EAAK,CAAEI,YAAY,EAAMC,IAAKN,EAAWC,IAE1E,ECNDR,EAAwB,CAACc,EAAKC,IAAUL,OAAOM,UAAUC,eAAeC,KAAKJ,EAAKC,GCClFf,EAAyBM,IACH,oBAAXa,QAA0BA,OAAOC,aAC1CV,OAAOC,eAAeL,EAASa,OAAOC,YAAa,CAAEC,MAAO,WAE7DX,OAAOC,eAAeL,EAAS,aAAc,CAAEe,OAAO,GAAO,G,qECL9D,MAAM,EAA+BC,OAAOC,KAAKC,OAAO,a,aCAxD,SAASC,EAAgBC,EAAGC,GAC1B,OAAOF,EAAkBf,OAAOkB,eAAiBlB,OAAOkB,eAAeC,OAAS,SAAUH,EAAGC,GAC3F,OAAOD,EAAEI,UAAYH,EAAGD,CAC1B,EAAGD,EAAgBC,EAAGC,EACxB,CCJA,MAAM,EAA+BL,OAAOC,KAAKC,OAAO,0B,aCAxD,MAAM,EAA+BF,OAAOC,KAAKC,OAAO,sC,aCAxD,MAAM,EAA+BF,OAAOC,KAAKC,OAAO,4B,aCAxD,MAAM,EAA+BF,OAAOC,KAAKC,OAAO,4B,aCKnCO,EAAU,SAAAC,GAAA,SAAAD,IAAA,OAAAC,EAAAC,MAAA,KAAAC,YAAA,KCJ/B,IAAwBR,EAAGjB,IDIIuB,GCJPN,EDIOK,GCH3Bf,UAAYN,OAAOyB,OAAO1B,EAAEO,WAAYU,EAAEV,UAAUoB,YAAcV,EAAGE,EAAeF,EAAGjB,GDG5D,IAAA4B,EAAAN,EAAAf,UAwpB5B,OAxpB4BqB,EAC7BC,OAAA,SAAOC,GACLP,EAAAhB,UAAMsB,OAAMpB,KAAC,KAAAqB,GAEbC,KAAKC,QAAU,CACbC,QAAQ,EACRC,QAAQ,EACRC,OAAO,EACPC,SAAS,EACTC,MAAM,GAGRN,KAAKE,OAAS,GACdF,KAAKG,OAAS,GACdH,KAAKI,MAAQ,GACbJ,KAAKK,QAAU,GACfL,KAAKM,KAAO,KAEZN,KAAKO,gBAAkB,KACvBP,KAAKQ,gBAAkB,KACvBR,KAAKS,eAAiB,KACtBT,KAAKU,iBAAmB,KAExBV,KAAKW,YAAc,EAEnBX,KAAKY,YACP,EAACf,EAEDgB,KAAA,WAAO,IAAAC,EAODC,EALEC,EAAcC,IAAIC,MAAMC,UAAU,wBACb,OADkCL,EAC1CG,IAAIG,OAAc,OAAVN,EAARA,EAAUO,eAAQ,EAAlBP,EAAqB,uCACrB,kBAkBnB,OAXEC,EADEE,IAAIC,OAASD,IAAIC,MAAMC,UAAU,qBACtBF,IAAIC,MAAMC,UAAU,qBAG1BF,IAAIG,MAAQH,IAAIG,KAAKC,UAAYJ,IAAIG,KAAKC,SAAS,oCAC7CJ,IAAIG,KAAKC,SAAS,oCAIlB,+KAIbC,EAAA,OAAKC,UAAU,cACbD,EAAA,OAAKC,UAAU,aACbD,EAAA,UAAKN,GACLM,EAAA,SAAIP,GACJO,EAAA,KAAGC,UAAU,kBAAiB,uEAE9BD,EAAA,OAAKC,UAAU,qBACbD,EAAA,OAAKC,UAAU,gCACbD,EAAA,OAAKC,UAAU,sBACfD,EAAA,YAAM,UAERA,EAAA,OAAKC,UAAW,sBAAwBvB,KAAKO,gBAAkB,aAAe,KAC5Ee,EAAA,OAAKC,UAAU,sBACfD,EAAA,YAAM,UAERA,EAAA,OAAKC,UAAW,sBAAwBvB,KAAKQ,gBAAkB,aAAe,KAC5Ec,EAAA,OAAKC,UAAU,sBACfD,EAAA,YAAM,UAERA,EAAA,OAAKC,UAAW,sBAAwBvB,KAAKS,eAAiB,aAAe,KAC3Ea,EAAA,OAAKC,UAAU,sBACfD,EAAA,YAAM,SAERA,EAAA,OAAKC,UAAW,sBAAwBvB,KAAKU,iBAAmB,aAAe,KAC7EY,EAAA,OAAKC,UAAU,sBACfD,EAAA,YAAM,YAIVA,EAAA,OAAKC,UAAU,6BACbD,EAAA,OAAKC,UAAW,cAAgBvB,KAAKwB,cAAc,SAAW,UAAY,KACxEF,EAAA,aAAO,aACNtB,KAAKC,QAAQC,OACZoB,EAACG,IAAgB,MAEjBH,EAACI,IAAM,CACL7C,MAAOmB,KAAKO,iBAAmB,GAC/BoB,QAAS3B,KAAK4B,kBACdC,SAAU7B,KAAK8B,cAAczC,KAAKW,SAKxCsB,EAAA,OAAKC,UAAW,cAAgBvB,KAAKwB,cAAc,SAAW,UAAY,KACxEF,EAAA,aAAO,aACNtB,KAAKC,QAAQE,OACZmB,EAACG,IAAgB,MAEjBH,EAACI,IAAM,CACL7C,MAAOmB,KAAKQ,iBAAmB,GAC/BmB,QAAS3B,KAAK+B,kBACdF,SAAU7B,KAAKgC,cAAc3C,KAAKW,MAClCiC,UAAWjC,KAAKO,mBAGlBP,KAAKO,iBAAmBe,EAAA,SAAOC,UAAU,iBAAgB,oCAG7DD,EAAA,OAAKC,UAAW,cAAgBvB,KAAKwB,cAAc,QAAU,UAAY,KACvEF,EAAA,aAAO,cACNtB,KAAKC,QAAQG,MACZkB,EAACG,IAAgB,MAEjBH,EAACI,IAAM,CACL7C,MAAOmB,KAAKS,gBAAkB,GAC9BkB,QAAS3B,KAAKkC,iBACdL,SAAU7B,KAAKmC,aAAa9C,KAAKW,MACjCiC,UAAWjC,KAAKQ,mBAGlBR,KAAKQ,iBAAmBc,EAAA,SAAOC,UAAU,iBAAgB,oCAG7DD,EAAA,OAAKC,UAAW,cAAgBvB,KAAKwB,cAAc,UAAY,UAAY,KACzEF,EAAA,aAAO,iBACNtB,KAAKC,QAAQI,QACZiB,EAACG,IAAgB,MAEjBH,EAACI,IAAM,CACL7C,MAAOmB,KAAKU,kBAAoB,GAChCiB,QAAS3B,KAAKoC,mBACdP,SAAU7B,KAAKqC,eAAehD,KAAKW,MACnCiC,UAAWjC,KAAKS,kBAGlBT,KAAKS,gBAAkBa,EAAA,SAAOC,UAAU,iBAAgB,sCAI7DvB,KAAKC,QAAQK,KACZgB,EAACG,IAAgB,MACfzB,KAAKM,MAAQN,KAAKM,KAAKgC,YAActC,KAAKM,KAAKgC,WAAWC,IAC5DvC,KAAKwC,kBAAkBxC,KAAKM,KAAKgC,WAAWC,IAAKvC,KAAKM,KAAKgC,WAAWG,aACpEzC,KAAKU,iBACPY,EAAA,OAAKC,UAAU,mBAAmBmB,MAAO,CACvCC,OAAQ,SACRC,QAAS,OACTC,aAAc,MACdC,QAAS,OACTC,WAAY,WAEZzB,EAAA,KAAGC,UAAU,qBAAqBmB,MAAO,CAACM,YAAa,OAAQC,SAAU,OAAQC,MAAO,aACxF5B,EAAA,WACEA,EAAA,KAAGoB,MAAO,CAACC,OAAQ,IAAKQ,WAAY,SAAS,wDAC7C7B,EAAA,KAAGoB,MAAO,CAACC,OAAQ,cAAc,yEAGnC,MAIZ,EAAC9C,EAED2C,kBAAA,SAAkBD,EAAKE,GAAa,IAAAW,EAAA,KAC5BC,EAAQrD,KAAKsD,SAASf,GACtBgB,EAAUvD,KAAKwD,WAAWjB,GAEhC,OACEjB,EAAA,OAAKC,UAAU,gBAAgBmB,MAAO,CAACe,UAAW,OAAQC,aAAc,SACrEL,EACC/B,EAAA,OAAKoB,MAAO,CACViB,OAAQ,oBACRd,aAAc,MACdF,OAAQ,YACRiB,gBAAiB,YAEjBtC,EAAA,OAAKoB,MAAO,CACVmB,MAAO,OACPC,OAAQ,QACRC,SAAU,SACVC,SAAU,aAEV1C,EAAA,UACE2C,IAAKjE,KAAKkE,cAAc3B,GACxBG,MAAO,CACLmB,MAAO,OACPC,OAAQ,OACRH,OAAQ,QAEVQ,MAAM,mCACNC,OAAQ,SAACjF,GAEPkF,YAAW,WACT,GAAIlF,EAAEmF,QAAUnF,EAAEmF,OAAOC,cACvB,IACEpF,EAAEmF,OAAOC,cAAcC,SAASC,QAClC,CAAE,MAAOC,GACPC,QAAQC,IAAI,wDACd,CAEJ,GAAG,KAGHP,YAAW,WACT,GAAIlF,EAAEmF,OAAQ,CACZ,IAAMO,EAAa1F,EAAEmF,OAAOL,IAC5B9E,EAAEmF,OAAOL,IAAM,GACfI,YAAW,WACTlF,EAAEmF,OAAOL,IAAMY,CACjB,GAAG,IACL,CACF,GAAG,IACL,EACAC,QAAS,SAAC3F,GACRwF,QAAQD,MAAM,sBAAuBnC,GACrCpD,EAAEmF,OAAO5B,MAAMI,QAAU,OACzB,IAAMiC,EAAWC,SAASC,cAAc,OACxCF,EAASrC,MAAMwC,QAAU,kDACzBH,EAASI,UAAY,sQAIrBhG,EAAEmF,OAAOc,WAAWC,YAAYN,EAClC,MAIJxB,EACFjC,EAAA,OACE2C,IAAKjE,KAAKsF,qBAAqB/C,GAC/BgD,IAAI,uBACJ7C,MAAO,CACLmB,MAAO,OACPC,OAAQ,OACRhB,QAAS,QACTH,OAAQ,YACR6C,UAAW,QACXC,UAAW,UACX9B,OAAQ,oBACRd,aAAc,OAEhBiC,QAAS,SAAC3F,GACRwF,QAAQD,MAAM,wBAAyBnC,GACvCpD,EAAEmF,OAAO5B,MAAMI,QAAU,OACzB,IAAMiC,EAAWC,SAASC,cAAc,OACxCF,EAASxD,UAAY,qBACrBwD,EAASrC,MAAMC,OAAS,SACxBoC,EAASI,UAAY,wLAIrBhG,EAAEmF,OAAOc,WAAWM,aAAaX,EAAU5F,EAAEmF,OAAOqB,YACtD,IAGFrE,EAAA,OAAKoB,MAAO,CACVE,QAAS,OACTgD,UAAW,SACXjC,OAAQ,oBACRd,aAAc,MACdF,OAAQ,YACRiB,gBAAiB,YAEjBtC,EAAA,KAAGC,UAAU,cAAcmB,MAAO,CAACO,SAAU,OAAQC,MAAO,UAAWQ,aAAc,UACrFpC,EAAA,SAAG,iCAIPA,EAAA,OAAKoB,MAAO,CAAEkD,UAAW,SAAUjD,OAAQ,WACzCrB,EAACuE,IAAM,CACLtE,UAAU,yBACVuE,QAAS,WACHzC,EACF0C,OAAOC,KAAK5C,EAAK6C,eAAe1D,GAAM,UAEtCwD,OAAOC,KAAK5C,EAAKkC,qBAAqB/C,GAAM,SAEhD,EACA2D,KAAM7C,EAAQ,2BAA6BE,EAAU,eAAiB,2BACtEb,MAAO,CAAEM,YAAa,OAAQJ,QAAS,cAEtCS,EAAQ,yBAA2BE,EAAU,kBAAoB,aAEpEjC,EAACuE,IAAM,CACLtE,UAAU,2BACVuE,QAAS,WACP,IAAMxF,EAAO0E,SAASC,cAAc,KACpC3E,EAAK6F,KAAO/C,EAAKgD,eAAe7D,GAChCjC,EAAK+F,SAAWhD,EAAQ,2BAA6BE,EAAU,2BAA6B,uBAC5FjD,EAAKgG,OACP,EACAJ,KAAK,kBACLxD,MAAO,CAAEE,QAAS,cACnB,YACWS,EAAQ,MAAQE,EAAU,QAAU,SAKxD,EAAC1D,EAED+B,gBAAA,WACE,IAAID,EAAU,CACdA,GAAc,IAQd,OANI3B,KAAKE,QAAUF,KAAKE,OAAOqG,QAC7BvG,KAAKE,OAAOsG,SAAQ,SAAAC,GAClB9E,EAAQ8E,EAAMC,IAAMD,EAAMnE,WAAWqE,IACvC,IAGKhF,CACT,EAAC9B,EAEDkC,gBAAA,WACE,IAAIJ,EAAU,CACdA,GAAc,IAQd,OANI3B,KAAKG,QAAUH,KAAKG,OAAOoG,QAC7BvG,KAAKG,OAAOqG,SAAQ,SAAAI,GAClBjF,EAAQiF,EAAMF,IAAME,EAAMtE,WAAWqE,IACvC,IAGKhF,CACT,EAAC9B,EAEDqC,eAAA,WACE,IAAIP,EAAU,CACdA,GAAc,IAQd,OANI3B,KAAKI,OAASJ,KAAKI,MAAMmG,QAC3BvG,KAAKI,MAAMoG,SAAQ,SAAAK,GACjBlF,EAAQkF,EAAKH,IAAMG,EAAKvE,WAAWwE,UACrC,IAGKnF,CACT,EAAC9B,EAEDuC,iBAAA,WACE,IAAIT,EAAU,CACdA,GAAc,IAQd,OANI3B,KAAKK,SAAWL,KAAKK,QAAQkG,QAC/BvG,KAAKK,QAAQmG,SAAQ,SAAAO,GACnBpF,EAAQoF,EAAOL,IAAMK,EAAOzE,WAAWqE,IACzC,IAGKhF,CACT,EAAC9B,EAEDiC,cAAA,SAAckF,GAAS,IAAAC,EAAA,KACrBjH,KAAKO,gBAAkByG,GAAW,KAClChH,KAAKQ,gBAAkB,KACvBR,KAAKS,eAAiB,KACtBT,KAAKU,iBAAmB,KACxBV,KAAKM,KAAO,KAERN,KAAKO,iBACPP,KAAKkH,cAAgBlH,KAAKE,OAAOiH,MAAK,SAAAV,GAAK,OAAIA,EAAMC,KAAOO,EAAK1G,eAAe,IAChFP,KAAKoH,eAELpH,KAAKG,OAAS,GACdH,KAAKI,MAAQ,GACbJ,KAAKK,QAAU,GACfiB,EAAE+F,SAEN,EAACxH,EAEDmC,cAAA,SAAcsF,GAAS,IAAAC,EAAA,KACrBvH,KAAKQ,gBAAkB8G,GAAW,KAClCtH,KAAKS,eAAiB,KACtBT,KAAKU,iBAAmB,KACxBV,KAAKM,KAAO,KAERN,KAAKQ,iBACPR,KAAKwH,cAAgBxH,KAAKG,OAAOgH,MAAK,SAAAP,GAAK,OAAIA,EAAMF,KAAOa,EAAK/G,eAAe,IAChFR,KAAKyH,cAELzH,KAAKI,MAAQ,GACbJ,KAAKK,QAAU,GACfiB,EAAE+F,SAEN,EAACxH,EAEDsC,aAAA,SAAauF,GAAQ,IAAAC,EAAA,KACnB3H,KAAKS,eAAiBiH,GAAU,KAChC1H,KAAKU,iBAAmB,KACxBV,KAAKM,KAAO,KAERN,KAAKS,gBACPT,KAAK4H,aAAe5H,KAAKI,MAAM+G,MAAK,SAAAN,GAAI,OAAIA,EAAKH,KAAOiB,EAAKlH,cAAc,IAC3ET,KAAK6H,gBAEL7H,KAAKK,QAAU,GACfiB,EAAE+F,SAEN,EAACxH,EAEDwC,eAAA,SAAeyF,GAAU,IAAAC,EAAA,KACvB/H,KAAKU,iBAAmBoH,GAAY,KAEhC9H,KAAKU,kBACPV,KAAKgI,eAAiBhI,KAAKK,QAAQ8G,MAAK,SAAAJ,GAAM,OAAIA,EAAOL,KAAOqB,EAAKrH,gBAAgB,IACrFV,KAAKiI,aAELjI,KAAKM,KAAO,KACZgB,EAAE+F,SAEN,EAACxH,EAEDe,WAAA,WAAa,IAAAsH,EAAA,KACXlI,KAAKC,QAAQC,QAAS,EAEtBe,IAAIkH,QAAQ,CACVC,OAAQ,MACR7F,IAAKtB,IAAIC,MAAMC,UAAU,UAAY,mBACpCkH,MAAK,SAAAC,GACNJ,EAAKhI,OAASoI,EAAOlH,MAAQ,GAC7B8G,EAAKjI,QAAQC,QAAS,EACtBoB,EAAE+F,QACJ,IAAE,OAAO,SAAA3C,GACPC,QAAQD,MAAM,wBAAyBA,GACvCwD,EAAKjI,QAAQC,QAAS,EACtBoB,EAAE+F,QACJ,GACF,EAACxH,EAEDuH,WAAA,WAAa,IAAAmB,EAAA,KACXvI,KAAKC,QAAQE,QAAS,EAEtBc,IAAIkH,QAAQ,CACVC,OAAQ,MACR7F,IAAKtB,IAAIC,MAAMC,UAAU,UAAY,iBACrCqH,OAAQ,CACN,mBAAoBxI,KAAKO,mBAE1B8H,MAAK,SAAAC,GACFA,GAAUA,EAAOlH,KACnBmH,EAAKpI,OAASmI,EAAOlH,KAErBmH,EAAKpI,OAAS,GAEhBoI,EAAKtI,QAAQE,QAAS,EACtBmB,EAAE+F,QACJ,IAAE,OAAO,SAAA3C,GACPC,QAAQD,MAAM,wBAAyBA,GACvC6D,EAAKpI,OAAS,GACdoI,EAAKtI,QAAQE,QAAS,EACtBmB,EAAE+F,QACJ,GACF,EAACxH,EAED4H,UAAA,WAAY,IAAAgB,EAAA,KACVzI,KAAKC,QAAQG,OAAQ,EAErBa,IAAIkH,QAAQ,CACVC,OAAQ,MACR7F,IAAKtB,IAAIC,MAAMC,UAAU,UAAY,gBACrCqH,OAAQ,CACN,mBAAoBxI,KAAKQ,mBAE1B6H,MAAK,SAAAC,GACNG,EAAKrI,MAAQkI,EAAOlH,MAAQ,GAC5BqH,EAAKxI,QAAQG,OAAQ,EACrBkB,EAAE+F,QACJ,IAAE,OAAO,SAAA3C,GACPC,QAAQD,MAAM,uBAAwBA,GACtC+D,EAAKrI,MAAQ,GACbqI,EAAKxI,QAAQG,OAAQ,EACrBkB,EAAE+F,QACJ,GACF,EAACxH,EAEDgI,YAAA,WAAc,IAAAa,EAAA,KACZ1I,KAAKC,QAAQI,SAAU,EAEvBY,IAAIkH,QAAQ,CACVC,OAAQ,MACR7F,IAAKtB,IAAIC,MAAMC,UAAU,UAAY,kBACrCqH,OAAQ,CACN,kBAAmBxI,KAAKS,kBAEzB4H,MAAK,SAAAC,GACNI,EAAKrI,QAAUiI,EAAOlH,MAAQ,GAC9BsH,EAAKzI,QAAQI,SAAU,EACvBiB,EAAE+F,QACJ,IAAE,OAAO,SAAA3C,GACPC,QAAQD,MAAM,yBAA0BA,GACxCgE,EAAKrI,QAAU,GACfqI,EAAKzI,QAAQI,SAAU,EACvBiB,EAAE+F,QACJ,GACF,EAACxH,EAEDoI,SAAA,WAAW,IAAAU,EAAA,KACT3I,KAAKC,QAAQK,MAAO,EAEpBW,IAAIkH,QAAQ,CACVC,OAAQ,MACR7F,IAAKtB,IAAIC,MAAMC,UAAU,UAAY,gBACrCqH,OAAQ,CACN,oBAAqBxI,KAAKU,oBAE3B2H,MAAK,SAAAC,GACFA,EAAOlH,MAAQkH,EAAOlH,KAAKmF,OAAS,EACtCoC,EAAKrI,KAAOgI,EAAOlH,KAAK,GAExBuH,EAAKrI,KAAO,KAEdqI,EAAK1I,QAAQK,MAAO,EACpBgB,EAAE+F,QACJ,IAAE,OAAO,SAAA3C,GACPC,QAAQD,MAAM,sBAAuBA,GACrCiE,EAAKrI,KAAO,KACZqI,EAAK1I,QAAQK,MAAO,EACpBgB,EAAE+F,QACJ,GACF,EAACxH,EAED2B,cAAA,SAAcoH,GACZ,MAAa,UAATA,GAA0B5I,KAAKO,gBACtB,UAATqI,EAAyB5I,KAAKO,kBAAoBP,KAAKQ,gBAC9C,SAAToI,EAAwB5I,KAAKQ,kBAAoBR,KAAKS,eAC7C,WAATmI,GAA0B5I,KAAKS,iBAAmBT,KAAKU,gBAE7D,EAACb,EAEDoG,eAAA,SAAe1D,GACb,IACE,IAAKA,EAAK,MAAO,GAEjB,GAAIA,EAAIsG,SAAS,oBAAqB,CACpC,IAAMC,EAAS9I,KAAK+I,yBAAyBxG,GAC7C,OAAIuG,EACK,mCAAmCA,EAAM,QAE3CvG,CACT,CAEA,OAAOvC,KAAKsF,qBAAqB/C,EACnC,CAAE,MAAOmC,GAEP,OADAC,QAAQD,MAAM,kCAAmCA,GAC1CnC,CACT,CACF,EAAC1C,EAEDqE,cAAA,SAAc3B,GACZ,IACE,IAAKA,EAAK,MAAO,GAEjB,GAAIA,EAAIsG,SAAS,oBAAqB,CACpC,IAAMC,EAAS9I,KAAK+I,yBAAyBxG,GAC7C,OAAIuG,EACK,mCAAmCA,EAAM,qCAE3CvG,CACT,CAEA,OAAOvC,KAAKsF,qBAAqB/C,EACnC,CAAE,MAAOmC,GAEP,OADAC,QAAQD,MAAM,gCAAiCA,GACxCnC,CACT,CACF,EAAC1C,EAEDuG,eAAA,SAAe7D,GACb,IACE,IAAKA,EAAK,MAAO,GAEjB,GAAIA,EAAIsG,SAAS,oBAAqB,CACpC,IAAMC,EAAS9I,KAAK+I,yBAAyBxG,GAC7C,OAAIuG,EACK,kDAAkDA,EAEpDvG,CACT,CAEA,OAAOvC,KAAKsF,qBAAqB/C,EACnC,CAAE,MAAOmC,GAEP,OADAC,QAAQD,MAAM,iCAAkCA,GACzCnC,CACT,CACF,EAAC1C,EAEDyF,qBAAA,SAAqB/C,GACnB,IACE,IAAKA,EAAK,MAAO,GAEjB,GAAIA,EAAIsG,SAAS,oBAAqB,CACpC,IAAMC,EAAS9I,KAAK+I,yBAAyBxG,GAC7C,OAAIuG,EACK,mCAAmCA,EAAM,QAE3CvG,CACT,CAEA,OAAIA,EAAIyG,WAAW,MACD/H,IAAIC,MAAMC,UAAU,YAAc,IACjCoB,EAGfA,EAAIyG,WAAW,MACV,SAAWzG,EAGfA,EAAI0G,MAAM,iBAIR1G,EAHE,WAAaA,CAIxB,CAAE,MAAOmC,GAEP,OADAC,QAAQD,MAAM,iCAAkCA,GACzCnC,CACT,CACF,EAAC1C,EAEDkJ,yBAAA,SAAyBxG,GACvB,IAAKA,EAAK,OAAO,KASjB,IAPA,IAOA2G,EAAA,EAAAC,EAPiB,CACf,wBACA,sBACA,8BACA,iDAG0BD,EAAAC,EAAA5C,OAAA2C,IAAE,CAAzB,IAAIE,EAAOD,EAAAD,GACRD,EAAQ1G,EAAI0G,MAAMG,GACxB,GAAIH,EAAO,OAAOA,EAAM,EAC1B,CAEA,OAAO,IACT,EAACpJ,EAED2D,WAAA,SAAWjB,GACT,QAAKA,GAEuB,kCACD8G,KAAK9G,EAClC,EAAC1C,EAEDyJ,iBAAA,SAAiB/G,GACf,QAAKA,IACEA,EAAIsG,SAAS,qBAAuBtG,EAAIsG,SAAS,mBAC1D,EAAChJ,EAEDyD,SAAA,SAASf,GACP,QAAKA,MAEqB,UAEJ8G,KAAK9G,MAIvBA,EAAIsG,SAAS,oBAKnB,EAACtJ,CAAA,CAxpB4B,CAASgK,KELxC,MAAM,EAA+BzK,OAAOC,KAAKC,OAAO,iBCAlD,EAA+BF,OAAOC,KAAKC,OAAO,8B,aCAxD,MAAM,EAA+BF,OAAOC,KAAKC,OAAO,gC,aCMxDiC,IAAAA,aAAiBuI,IAAI,yBAAyB,WAE5CvI,IAAAA,OAAWwI,OAAS,CAClBC,KAAM,UACNC,UAAWpK,IAIbqK,EAAAA,EAAAA,QAAOC,IAAAA,UAAqB,YAAY,SAASC,GAAO,IAAAhJ,EAEhDE,EAAcC,IAAAA,MAAUE,UAAU,wBACb,OADkCL,EAC1CG,IAAAA,OAAkB,OAAVH,EAARA,EAAUO,eAAQ,EAAlBP,EAAqB,uCACrB,kBAEnBgJ,EAAMN,IAAI,kBACRlI,EAACyI,IAAU,CACT7D,KAAK,aACLC,KAAMlF,IAAAA,MAAU,WAEfD,GAEH,GAEJ,GACF,G","sources":["webpack://@ltydi/canbus-settings/webpack/bootstrap","webpack://@ltydi/canbus-settings/webpack/runtime/compat get default export","webpack://@ltydi/canbus-settings/webpack/runtime/define property getters","webpack://@ltydi/canbus-settings/webpack/runtime/hasOwnProperty shorthand","webpack://@ltydi/canbus-settings/webpack/runtime/make namespace object","webpack://@ltydi/canbus-settings/external root \"flarum.core.compat['forum/app']\"","webpack://@ltydi/canbus-settings/./node_modules/@babel/runtime/helpers/esm/setPrototypeOf.js","webpack://@ltydi/canbus-settings/external root \"flarum.core.compat['common/components/Page']\"","webpack://@ltydi/canbus-settings/external root \"flarum.core.compat['common/components/LoadingIndicator']\"","webpack://@ltydi/canbus-settings/external root \"flarum.core.compat['common/components/Select']\"","webpack://@ltydi/canbus-settings/external root \"flarum.core.compat['common/components/Button']\"","webpack://@ltydi/canbus-settings/./src/forum/components/CanBusPage.js","webpack://@ltydi/canbus-settings/./node_modules/@babel/runtime/helpers/esm/inheritsLoose.js","webpack://@ltydi/canbus-settings/external root \"flarum.core.compat['common/extend']\"","webpack://@ltydi/canbus-settings/external root \"flarum.core.compat['forum/components/IndexPage']\"","webpack://@ltydi/canbus-settings/external root \"flarum.core.compat['common/components/LinkButton']\"","webpack://@ltydi/canbus-settings/./src/forum/index.js"],"sourcesContent":["// The require scope\nvar __webpack_require__ = {};\n\n","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = (module) => {\n\tvar getter = module && module.__esModule ?\n\t\t() => (module['default']) :\n\t\t() => (module);\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['forum/app'];","function _setPrototypeOf(t, e) {\n  return _setPrototypeOf = Object.setPrototypeOf ? Object.setPrototypeOf.bind() : function (t, e) {\n    return t.__proto__ = e, t;\n  }, _setPrototypeOf(t, e);\n}\nexport { _setPrototypeOf as default };","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/components/Page'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/components/LoadingIndicator'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/components/Select'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/components/Button'];","import Page from 'flarum/common/components/Page';\nimport LoadingIndicator from 'flarum/common/components/LoadingIndicator';\nimport Select from 'flarum/common/components/Select';\nimport Button from 'flarum/common/components/Button';\n\nexport default class CanBusPage extends Page {\n  oninit(vnode) {\n    super.oninit(vnode);\n    \n    this.loading = {\n      brands: true,\n      models: false,\n      years: false,\n      configs: false,\n      link: false\n    };\n    \n    this.brands = [];\n    this.models = [];\n    this.years = [];\n    this.configs = [];\n    this.link = null;\n    \n    this.selectedBrandId = null;\n    this.selectedModelId = null;\n    this.selectedYearId = null;\n    this.selectedConfigId = null;\n    \n    this.currentStep = 1;\n    \n    this.loadBrands();\n  }\n  \n  view() {\n    // 获取自定义显示名称\n    const displayName = app.forum.attribute('canbus.displayName') || \n                       app.data?.settings?.['ltydi-canbus-settings.displayName'] || \n                       'CanBus Settings';\n    \n    // 使用多种方式获取提示文本，确保有备用\n    let promptText = '';\n    \n    // 尝试从app.forum.attributes获取（首选方式）\n    if (app.forum && app.forum.attribute('canbus.promptText')) {\n      promptText = app.forum.attribute('canbus.promptText');\n    } \n    // 如果上面的方式失败，尝试从app.data.settings获取\n    else if (app.data && app.data.settings && app.data.settings['ltydi-canbus-settings.promptText']) {\n      promptText = app.data.settings['ltydi-canbus-settings.promptText'];\n    }\n    // 如果仍然没有，使用默认文本\n    else {\n      promptText = \"Please select the appropriate CANBUs type based on the actual product you received. To access the CANBUs settings, navigate to: Settings- Factory (enter \\\"3368\\\")→ Car Model.\";\n    }\n    \n    return (\n      <div className=\"CanBusPage\">\n        <div className=\"container\">\n          <h2>{displayName}</h2>\n          <p>{promptText}</p>\n          <p className=\"SelectionOrder\">Selection order: Car Brand → Car Model → Year Range → Configuration</p>\n          \n          <div className=\"CanBusProgressBar\">\n            <div className=\"CanBusProgressStep completed\">\n              <div className=\"CanBusProgressDot\"></div>\n              <span>Start</span>\n            </div>\n            <div className={\"CanBusProgressStep\" + (this.selectedBrandId ? ' completed' : '')}>\n              <div className=\"CanBusProgressDot\"></div>\n              <span>Brand</span>\n            </div>\n            <div className={\"CanBusProgressStep\" + (this.selectedModelId ? ' completed' : '')}>\n              <div className=\"CanBusProgressDot\"></div>\n              <span>Model</span>\n            </div>\n            <div className={\"CanBusProgressStep\" + (this.selectedYearId ? ' completed' : '')}>\n              <div className=\"CanBusProgressDot\"></div>\n              <span>Year</span>\n            </div>\n            <div className={\"CanBusProgressStep\" + (this.selectedConfigId ? ' completed' : '')}>\n              <div className=\"CanBusProgressDot\"></div>\n              <span>Config</span>\n            </div>\n          </div>\n          \n          <div className=\"CanBusSelectors-container\">\n            <div className={\"Form-group\" + (this.isCurrentStep('brand') ? ' active' : '')}>\n              <label>Car Brand</label>\n              {this.loading.brands ? (\n                <LoadingIndicator />\n              ) : (\n                <Select\n                  value={this.selectedBrandId || ''}\n                  options={this.getBrandOptions()}\n                  onchange={this.onBrandChange.bind(this)}\n                />\n              )}\n            </div>\n            \n            <div className={\"Form-group\" + (this.isCurrentStep('model') ? ' active' : '')}>\n              <label>Car Model</label>\n              {this.loading.models ? (\n                <LoadingIndicator />\n              ) : (\n                <Select\n                  value={this.selectedModelId || ''}\n                  options={this.getModelOptions()}\n                  onchange={this.onModelChange.bind(this)}\n                  disabled={!this.selectedBrandId}\n                />\n              )}\n              {!this.selectedBrandId && <small className=\"SelectionHint\">Please select a Car Brand first</small>}\n            </div>\n            \n            <div className={\"Form-group\" + (this.isCurrentStep('year') ? ' active' : '')}>\n              <label>Year Range</label>\n              {this.loading.years ? (\n                <LoadingIndicator />\n              ) : (\n                <Select\n                  value={this.selectedYearId || ''}\n                  options={this.getYearOptions()}\n                  onchange={this.onYearChange.bind(this)}\n                  disabled={!this.selectedModelId}\n                />\n              )}\n              {!this.selectedModelId && <small className=\"SelectionHint\">Please select a Car Model first</small>}\n            </div>\n            \n            <div className={\"Form-group\" + (this.isCurrentStep('config') ? ' active' : '')}>\n              <label>Configuration</label>\n              {this.loading.configs ? (\n                <LoadingIndicator />\n              ) : (\n                <Select\n                  value={this.selectedConfigId || ''}\n                  options={this.getConfigOptions()}\n                  onchange={this.onConfigChange.bind(this)}\n                  disabled={!this.selectedYearId}\n                />\n              )}\n              {!this.selectedYearId && <small className=\"SelectionHint\">Please select a Year Range first</small>}\n            </div>\n          </div>\n          \n          {this.loading.link ? (\n            <LoadingIndicator />\n          ) : this.link && this.link.attributes && this.link.attributes.url ? (\n            this.renderLinkContent(this.link.attributes.url, this.link.attributes.description)\n          ) : this.selectedConfigId ? (\n            <div className=\"alert alert-info\" style={{\n              margin: '30px 0',\n              padding: '20px',\n              borderRadius: '4px',\n              display: 'flex',\n              alignItems: 'center'\n            }}>\n              <i className=\"fas fa-info-circle\" style={{marginRight: '10px', fontSize: '24px', color: '#3176d9'}}></i>\n              <div>\n                <p style={{margin: '0', fontWeight: 'bold'}}>No configuration image available for this selection.</p>\n                <p style={{margin: '5px 0 0 0'}}>Please try another configuration or contact support for assistance.</p>\n              </div>\n            </div>\n          ) : null}\n        </div>\n      </div>\n    );\n  }\n  \n  renderLinkContent(url, description) {\n    const isPdf = this.isPdfUrl(url);\n    const isImage = this.isImageUrl(url);\n    \n    return (\n      <div className=\"CanBusContent\" style={{marginTop: '30px', marginBottom: '30px'}}>\n        {isPdf ? (\n          <div style={{\n            border: '1px solid #e9ecef',\n            borderRadius: '4px',\n            margin: '20px auto',\n            backgroundColor: '#f8f9fa'\n          }}>\n            <div style={{\n              width: '100%',\n              height: '500px',\n              overflow: 'hidden',\n              position: 'relative'\n            }}>\n              <iframe \n                src={this.getPreviewUrl(url)}\n                style={{\n                  width: '100%',\n                  height: '100%',\n                  border: 'none'\n                }}\n                title=\"CanBus Configuration PDF Preview\"\n                onload={(e) => {\n                  // 强制刷新iframe以解决多页PDF加载问题\n                  setTimeout(() => {\n                    if (e.target && e.target.contentWindow) {\n                      try {\n                        e.target.contentWindow.location.reload();\n                      } catch (error) {\n                        console.log('Cannot reload iframe due to cross-origin restrictions');\n                      }\n                    }\n                  }, 1000);\n                  \n                  // 延迟刷新机制\n                  setTimeout(() => {\n                    if (e.target) {\n                      const currentSrc = e.target.src;\n                      e.target.src = '';\n                      setTimeout(() => {\n                        e.target.src = currentSrc;\n                      }, 100);\n                    }\n                  }, 2000);\n                }}\n                onError={(e) => {\n                  console.error('PDF preview failed:', url);\n                  e.target.style.display = 'none';\n                  const errorDiv = document.createElement('div');\n                  errorDiv.style.cssText = 'padding: 40px; text-align: center; color: #666;';\n                  errorDiv.innerHTML = `\n                    <i class=\"fas fa-exclamation-triangle\" style=\"font-size: 24px; margin-bottom: 10px; color: #ffc107;\"></i>\n                    <p>PDF preview unavailable. Please use the buttons below to view or download the file.</p>\n                  `;\n                  e.target.parentNode.appendChild(errorDiv);\n                }}\n              />\n            </div>\n          </div>\n        ) : isImage ? (\n          <img \n            src={this.getDirectDownloadUrl(url)}\n            alt=\"CanBus Configuration\"\n            style={{\n              width: '100%',\n              height: 'auto',\n              display: 'block',\n              margin: '20px auto',\n              maxHeight: '600px',\n              objectFit: 'contain',\n              border: '1px solid #e9ecef',\n              borderRadius: '4px'\n            }}\n            onError={(e) => {\n              console.error('Image failed to load:', url);\n              e.target.style.display = 'none';\n              const errorDiv = document.createElement('div');\n              errorDiv.className = 'alert alert-danger';\n              errorDiv.style.margin = '20px 0';\n              errorDiv.innerHTML = `\n                <p><i class=\"fas fa-exclamation-triangle\"></i> Image failed to load</p>\n                <p>Please use the button below to open in a new window</p>\n              `;\n              e.target.parentNode.insertBefore(errorDiv, e.target.nextSibling);\n            }}\n          />\n        ) : (\n          <div style={{\n            padding: '40px',\n            textAlign: 'center',\n            border: '1px solid #e9ecef',\n            borderRadius: '4px',\n            margin: '20px auto',\n            backgroundColor: '#f8f9fa'\n          }}>\n            <i className=\"fas fa-file\" style={{fontSize: '48px', color: '#6c757d', marginBottom: '15px'}}></i>\n            <p>Configuration file available</p>\n          </div>\n        )}\n        \n        <div style={{ textAlign: 'center', margin: '20px 0' }}>\n          <Button\n            className=\"Button Button--primary\"\n            onclick={() => {\n              if (isPdf) {\n                window.open(this.getFullViewUrl(url), '_blank');\n              } else {\n                window.open(this.getDirectDownloadUrl(url), '_blank');\n              }\n            }}\n            icon={isPdf ? \"fas fa-external-link-alt\" : isImage ? \"fas fa-image\" : \"fas fa-external-link-alt\"}\n            style={{ marginRight: '10px', padding: '10px 20px' }}\n          >\n            {isPdf ? 'Open PDF in New Window' : isImage ? 'View Full Image' : 'Open File'}\n          </Button>\n          <Button\n            className=\"Button Button--secondary\"\n            onclick={() => {\n              const link = document.createElement('a');\n              link.href = this.getDownloadUrl(url);\n              link.download = isPdf ? 'canbus-configuration.pdf' : isImage ? 'canbus-configuration.jpg' : 'canbus-configuration';\n              link.click();\n            }}\n            icon=\"fas fa-download\"\n            style={{ padding: '10px 20px' }}\n          >\n            Download {isPdf ? 'PDF' : isImage ? 'Image' : 'File'}\n          </Button>\n        </div>\n      </div>\n    );\n  }\n  \n  getBrandOptions() {\n    let options = {};\n    options[''] = '';\n    \n    if (this.brands && this.brands.length) {\n      this.brands.forEach(brand => {\n        options[brand.id] = brand.attributes.name;\n      });\n    }\n    \n    return options;\n  }\n  \n  getModelOptions() {\n    let options = {};\n    options[''] = '';\n    \n    if (this.models && this.models.length) {\n      this.models.forEach(model => {\n        options[model.id] = model.attributes.name;\n      });\n    }\n    \n    return options;\n  }\n  \n  getYearOptions() {\n    let options = {};\n    options[''] = '';\n    \n    if (this.years && this.years.length) {\n      this.years.forEach(year => {\n        options[year.id] = year.attributes.year_range;\n      });\n    }\n    \n    return options;\n  }\n  \n  getConfigOptions() {\n    let options = {};\n    options[''] = '';\n    \n    if (this.configs && this.configs.length) {\n      this.configs.forEach(config => {\n        options[config.id] = config.attributes.name;\n      });\n    }\n    \n    return options;\n  }\n  \n  onBrandChange(brandId) {\n    this.selectedBrandId = brandId || null;\n    this.selectedModelId = null;\n    this.selectedYearId = null;\n    this.selectedConfigId = null;\n    this.link = null;\n    \n    if (this.selectedBrandId) {\n      this.selectedBrand = this.brands.find(brand => brand.id === this.selectedBrandId);\n      this.loadModels();\n    } else {\n      this.models = [];\n      this.years = [];\n      this.configs = [];\n      m.redraw();\n    }\n  }\n  \n  onModelChange(modelId) {\n    this.selectedModelId = modelId || null;\n    this.selectedYearId = null;\n    this.selectedConfigId = null;\n    this.link = null;\n    \n    if (this.selectedModelId) {\n      this.selectedModel = this.models.find(model => model.id === this.selectedModelId);\n      this.loadYears();\n    } else {\n      this.years = [];\n      this.configs = [];\n      m.redraw();\n    }\n  }\n  \n  onYearChange(yearId) {\n    this.selectedYearId = yearId || null;\n    this.selectedConfigId = null;\n    this.link = null;\n    \n    if (this.selectedYearId) {\n      this.selectedYear = this.years.find(year => year.id === this.selectedYearId);\n      this.loadConfigs();\n    } else {\n      this.configs = [];\n      m.redraw();\n    }\n  }\n  \n  onConfigChange(configId) {\n    this.selectedConfigId = configId || null;\n    \n    if (this.selectedConfigId) {\n      this.selectedConfig = this.configs.find(config => config.id === this.selectedConfigId);\n      this.loadLink();\n    } else {\n      this.link = null;\n      m.redraw();\n    }\n  }\n  \n  loadBrands() {\n    this.loading.brands = true;\n    \n    app.request({\n      method: 'GET',\n      url: app.forum.attribute('apiUrl') + '/canbus/brands'\n    }).then(result => {\n      this.brands = result.data || [];\n      this.loading.brands = false;\n      m.redraw();\n    }).catch(error => {\n      console.error('Error loading brands:', error);\n      this.loading.brands = false;\n      m.redraw();\n    });\n  }\n  \n  loadModels() {\n    this.loading.models = true;\n    \n    app.request({\n      method: 'GET',\n      url: app.forum.attribute('apiUrl') + '/canbus/models',\n      params: {\n        'filter[brand_id]': this.selectedBrandId\n      }\n    }).then(result => {\n      if (result && result.data) {\n        this.models = result.data;\n      } else {\n        this.models = [];\n      }\n      this.loading.models = false;\n      m.redraw();\n    }).catch(error => {\n      console.error('Error loading models:', error);\n      this.models = [];\n      this.loading.models = false;\n      m.redraw();\n    });\n  }\n  \n  loadYears() {\n    this.loading.years = true;\n    \n    app.request({\n      method: 'GET',\n      url: app.forum.attribute('apiUrl') + '/canbus/years',\n      params: {\n        'filter[model_id]': this.selectedModelId\n      }\n    }).then(result => {\n      this.years = result.data || [];\n      this.loading.years = false;\n      m.redraw();\n    }).catch(error => {\n      console.error('Error loading years:', error);\n      this.years = [];\n      this.loading.years = false;\n      m.redraw();\n    });\n  }\n  \n  loadConfigs() {\n    this.loading.configs = true;\n    \n    app.request({\n      method: 'GET',\n      url: app.forum.attribute('apiUrl') + '/canbus/configs',\n      params: {\n        'filter[year_id]': this.selectedYearId\n      }\n    }).then(result => {\n      this.configs = result.data || [];\n      this.loading.configs = false;\n      m.redraw();\n    }).catch(error => {\n      console.error('Error loading configs:', error);\n      this.configs = [];\n      this.loading.configs = false;\n      m.redraw();\n    });\n  }\n  \n  loadLink() {\n    this.loading.link = true;\n    \n    app.request({\n      method: 'GET',\n      url: app.forum.attribute('apiUrl') + '/canbus/links',\n      params: {\n        'filter[config_id]': this.selectedConfigId\n      }\n    }).then(result => {\n      if (result.data && result.data.length > 0) {\n        this.link = result.data[0];\n      } else {\n        this.link = null;\n      }\n      this.loading.link = false;\n      m.redraw();\n    }).catch(error => {\n      console.error('Error loading link:', error);\n      this.link = null;\n      this.loading.link = false;\n      m.redraw();\n    });\n  }\n  \n  isCurrentStep(step) {\n    if (step === 'brand') return !this.selectedBrandId;\n    if (step === 'model') return this.selectedBrandId && !this.selectedModelId;\n    if (step === 'year') return this.selectedModelId && !this.selectedYearId;\n    if (step === 'config') return this.selectedYearId && !this.selectedConfigId;\n    return false;\n  }\n\n  getFullViewUrl(url) {\n    try {\n      if (!url) return '';\n      \n      if (url.includes('drive.google.com')) {\n        const fileId = this.extractGoogleDriveFileId(url);\n        if (fileId) {\n          return `https://drive.google.com/file/d/${fileId}/view`;\n        }\n        return url;\n      }\n      \n      return this.getDirectDownloadUrl(url);\n    } catch (error) {\n      console.error('Error processing full view URL:', error);\n      return url;\n    }\n  }\n\n  getPreviewUrl(url) {\n    try {\n      if (!url) return '';\n      \n      if (url.includes('drive.google.com')) {\n        const fileId = this.extractGoogleDriveFileId(url);\n        if (fileId) {\n          return `https://drive.google.com/file/d/${fileId}/preview?usp=sharing&embedded=true`;\n        }\n        return url;\n      }\n      \n      return this.getDirectDownloadUrl(url);\n    } catch (error) {\n      console.error('Error processing preview URL:', error);\n      return url;\n    }\n  }\n\n  getDownloadUrl(url) {\n    try {\n      if (!url) return '';\n      \n      if (url.includes('drive.google.com')) {\n        const fileId = this.extractGoogleDriveFileId(url);\n        if (fileId) {\n          return `https://drive.google.com/uc?export=download&id=${fileId}`;\n        }\n        return url;\n      }\n      \n      return this.getDirectDownloadUrl(url);\n    } catch (error) {\n      console.error('Error processing download URL:', error);\n      return url;\n    }\n  }\n\n  getDirectDownloadUrl(url) {\n    try {\n      if (!url) return '';\n      \n      if (url.includes('drive.google.com')) {\n        const fileId = this.extractGoogleDriveFileId(url);\n        if (fileId) {\n          return `https://drive.google.com/file/d/${fileId}/view`;\n        }\n        return url;\n      }\n      \n      if (url.startsWith('/')) {\n        const baseUrl = app.forum.attribute('baseUrl') || '';\n        return baseUrl + url;\n      }\n      \n      if (url.startsWith('//')) {\n        return 'https:' + url;\n      }\n      \n      if (!url.match(/^https?:\\/\\//i)) {\n        return 'https://' + url;\n      }\n      \n      return url;\n    } catch (error) {\n      console.error('Error processing download URL:', error);\n      return url;\n    }\n  }\n   \n  extractGoogleDriveFileId(url) {\n    if (!url) return null;\n    \n    const patterns = [\n      /\\/d\\/([a-zA-Z0-9_-]+)/,\n      /id=([a-zA-Z0-9_-]+)/,\n      /\\/file\\/d\\/([a-zA-Z0-9_-]+)/,\n      /drive\\.google\\.com\\/open\\?id=([a-zA-Z0-9_-]+)/\n    ];\n    \n    for (let pattern of patterns) {\n      const match = url.match(pattern);\n      if (match) return match[1];\n    }\n    \n    return null;\n  }\n  \n  isImageUrl(url) {\n    if (!url) return false;\n    \n    const imageExtensionRegex = /\\.(jpg|jpeg|png|gif|bmp|webp)$/i;\n    return imageExtensionRegex.test(url);\n  }\n  \n  isGoogleDriveUrl(url) {\n    if (!url) return false;\n    return url.includes('drive.google.com') || url.includes('docs.google.com');\n  }\n\n  isPdfUrl(url) {\n    if (!url) return false;\n    \n    const pdfExtensionRegex = /\\.pdf$/i;\n    \n    if (pdfExtensionRegex.test(url)) {\n      return true;\n    }\n    \n    if (url.includes('drive.google.com')) {\n      return true;\n    }\n    \n    return false;\n  }\n}","import setPrototypeOf from \"./setPrototypeOf.js\";\nfunction _inheritsLoose(t, o) {\n  t.prototype = Object.create(o.prototype), t.prototype.constructor = t, setPrototypeOf(t, o);\n}\nexport { _inheritsLoose as default };","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/extend'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['forum/components/IndexPage'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/components/LinkButton'];","import app from 'flarum/forum/app';\nimport { extend } from 'flarum/common/extend';\nimport IndexPage from 'flarum/forum/components/IndexPage';\nimport LinkButton from 'flarum/common/components/LinkButton';\nimport CanBusPage from './components/CanBusPage';\n\napp.initializers.add('ltydi/canbus-settings', () => {\n  // 注册路由\n  app.routes.canbus = {\n    path: '/canbus',\n    component: CanBusPage\n  };\n\n  // 添加左侧导航项\n  extend(IndexPage.prototype, 'navItems', function(items) {\n    // 获取自定义显示名称，如果没有则使用默认值\n    const displayName = app.forum.attribute('canbus.displayName') || \n                       app.data?.settings?.['ltydi-canbus-settings.displayName'] || \n                       'CanBus Settings';\n    \n    items.add('canbus-settings',\n      <LinkButton \n        icon=\"fas fa-car\"\n        href={app.route('canbus')}\n      >\n        {displayName}\n      </LinkButton>,\n      85 // 位置优先级\n    );\n  });\n});"],"names":["__webpack_require__","module","getter","__esModule","d","a","exports","definition","key","o","Object","defineProperty","enumerable","get","obj","prop","prototype","hasOwnProperty","call","Symbol","toStringTag","value","flarum","core","compat","_setPrototypeOf","t","e","setPrototypeOf","bind","__proto__","CanBusPage","_Page","apply","arguments","create","constructor","_proto","oninit","vnode","this","loading","brands","models","years","configs","link","selectedBrandId","selectedModelId","selectedYearId","selectedConfigId","currentStep","loadBrands","view","_app$data","promptText","displayName","app","forum","attribute","data","settings","m","className","isCurrentStep","LoadingIndicator","Select","options","getBrandOptions","onchange","onBrandChange","getModelOptions","onModelChange","disabled","getYearOptions","onYearChange","getConfigOptions","onConfigChange","attributes","url","renderLinkContent","description","style","margin","padding","borderRadius","display","alignItems","marginRight","fontSize","color","fontWeight","_this","isPdf","isPdfUrl","isImage","isImageUrl","marginTop","marginBottom","border","backgroundColor","width","height","overflow","position","src","getPreviewUrl","title","onload","setTimeout","target","contentWindow","location","reload","error","console","log","currentSrc","onError","errorDiv","document","createElement","cssText","innerHTML","parentNode","appendChild","getDirectDownloadUrl","alt","maxHeight","objectFit","insertBefore","nextSibling","textAlign","Button","onclick","window","open","getFullViewUrl","icon","href","getDownloadUrl","download","click","length","forEach","brand","id","name","model","year","year_range","config","brandId","_this2","selectedBrand","find","loadModels","redraw","modelId","_this3","selectedModel","loadYears","yearId","_this4","selectedYear","loadConfigs","configId","_this5","selectedConfig","loadLink","_this6","request","method","then","result","_this7","params","_this8","_this9","_this10","step","includes","fileId","extractGoogleDriveFileId","startsWith","match","_i","_patterns","pattern","test","isGoogleDriveUrl","Page","add","canbus","path","component","extend","IndexPage","items","LinkButton"],"sourceRoot":""}